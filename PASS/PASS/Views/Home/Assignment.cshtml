<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Personal Web">
    <meta name="author" content="Chi Wu William Chiang">
    <link rel="shortcut icon" href="assets/ico/favicon.ico">
    <title>G5 classroom</title>
    <!-- Bootstrap core CSS -->
    <link href="~/Content/bootstrap.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="~/Content/IndexStyle.css" rel="stylesheet">
    <link href="~/Content/CourseStudents.css" rel="stylesheet">
    <link href="~/Content/font-awesome.min.css" rel="stylesheet">
    <link href="~/Content/assignmentStyle.css" rel="stylesheet">
</head>
<body>
    <!-- Static navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li class="active"><a href="http://localhost:50714/Home/Course">個人頁面</a></li>
                    <li><a href="#about">公告</a></li>
                    <li><a href="#works">作業</a></li>
                    <li class="logout"><a href="http://localhost:50714/Home/Index">登出</a></li>
                </ul>
            </div><!--/.nav-collapse -->
        </div>
    </div>

    <div id="headerwrap">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 col-lg-offset-3 chinese">
                    @*登入後改成顯示下面的*@
                    <h1 class="course-name">軟體工程</h1>
                    <h3 class="teacher">歡迎，你的身分是學生</h3>
                    <h3 class="ta">目前還沒有TA喔！</h3>
                </div>
            </div><! --/row -->
        </div> <!-- /container -->
    </div><! --/headerwrap -->

    <section id="about"></section>
    <div id="about">
        <div class="container">
            <div class="row centered mt mb chinese">
                <div class="title">
                    <h1>繳交資訊</h1>
                </div>

                <div>
                    <table>
                        <tr>
                            <td>學號：</td><td class="student-id"></td>
                        </tr>
                        <tr>
                            <td>繳交名稱：</td>
                            <td class="submit-name"></td>
                        </tr>
                        <tr>
                            <td>上傳時間：</td>
                            <td class="submit-time"></td>
                        </tr>
                        <tr>
                            <td>成績：</td>
                            <td class="submit-score"></td>
                        </tr>
                    </table>
                </div>

                <form action="@Url.Action("Upload")" method="post" enctype="multipart/form-data">
                    <input type="file" name="file" id="file" />
                    <input type="number" name="assignmentID" id="assignmentID" style="display: none;" />
                    <input type="submit" />
                </form>

            </div><! --/row -->
        </div><! --/container -->
    </div>



    <div id="social">
        <div class="container">
            <div class="row centered chinese login">
            </div><! --/row -->
        </div><! --/container -->
    </div><! --/social -->

    <div id="footerwrap">
        <div class="container">
            <div class="row centered">
                <div class="col-lg-4">
                    <p><b>ASSIGNMENT SUBMIT & CURSE DETAIL</b></p>
                </div>
                <div class="col-lg-4">
                    <p>G5 小教室 © 2017 William Chiang.</p>
                </div>
                <div class="col-lg-4">
                    <p>a912686931work@gmail.com</p>
                </div>
            </div>
        </div>
    </div><! --/footerwrap -->



    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>

    <script>
        //頁面載入
        $(function () {
            var ID = getUrlParameter('ID');
            $(".logout").click(DirectToIndex);
            $("#assignmentID").val(ID);
            ShowSubmitInfo(ID);
        });

        function openfileDialog() {
            $("#fileLoader").click();
        }


        //顯示繳交資訊
        function ShowSubmitInfo(ID) {
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetOneAssignmentSubmitInfo", "Home")',
                data: { "assignmentID": ID},
                success: function (response) {
                    try {
                        $("td.student-id").text(response[1]._studentId);
                        $("td.submit-name").text(response[1]._submitName);
                        var date = new Date(parseInt(response[1]._submitTime.substr(6)));
                        $("td.submit-time").text(date.getFullYear() + "/" + date.getMonth() + "/" + date.getDate() + " " + date.getHours() + ":" + date.getMinutes());
                        if (response[1]._submitScore == -1 || response[1]._submitScore == 0)
                            $("td.submit-score").text("未輸入");
                        else
                            $("td.submit-score").text(response[1]._submitScore);
                    }
                    catch (err) {
                        if (response == "Submit not found") {
                            $("td.submit-name").text("未上傳");
                        }
                        else {
                            alert(response);
                        }
                    }
                }
            });
        }

        //設定課程資訊
        function SetCourseInfo(ID) {
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetCourse", "Home")',
                data: { "courseId": ID },
                success: function (response) {
                    $(".course-name").text(response[0]._courseName);
                    $(".teacher").text("指導教授：" + response[0]._instructorID);

                    //如果有TA
                    if (response.length > 0) {
                        $(".ta").text(response[1]);
                    }
                }
            });
        }

        //重新導向到首頁
        function DirectToIndex() {
            $.ajax({
                type: 'POST',
                url: '@Url.Action("RedirectPage", "Home")',
                data: { "data": "Index" },
                success: function (response) {
                    window.location.href = response.url;
                }
            });
        };

        //取得url GET變數
        var getUrlParameter = function getUrlParameter(sParam) {
            var sPageURL = decodeURIComponent(window.location.search.substring(1)),
                sURLVariables = sPageURL.split('&'),
                sParameterName,
                i;

            for (i = 0; i < sURLVariables.length; i++) {
                sParameterName = sURLVariables[i].split('=');

                if (sParameterName[0] === sParam) {
                    return sParameterName[1] === undefined ? true : sParameterName[1];
                }
            }
        };
    </script>

</body>
</html>

